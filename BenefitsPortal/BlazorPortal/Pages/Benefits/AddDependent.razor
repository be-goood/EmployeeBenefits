@page "/benefits/dependent/add/{employeeId}"

@using BenefitsPortal.Domain.Models
@using BenefitsPortal.Domain.Interfaces
@inject IEBenefitsRepository eBenefitsRepository
@inject IDependentRepository dependentRepository
@inject NavigationManager navigation

<h1>Add New Dependent</h1>

<EditForm Model="@dependent" OnValidSubmit="@Add">
    @*<DataAnnotationsValidator />*@

    <div class="col-12 row">
        <label class="col-2 font-weight-bold">First name :</label>
        <input @ref="publisherNameTextBox" class="form-control col-3" @bind="dependent.FirstName" placeholder="First name" />
        &nbsp;<ValidationMessage For="@(() => dependent.FirstName)" />
    </div>
    <br />
    <div class="col-12 row">
        <label class="col-2 font-weight-bold">Last name :</label>
        <input @ref="publisherNameTextBox" class="form-control col-3" @bind="dependent.LastName" placeholder="Last name" />
        &nbsp;<ValidationMessage For="@(() => dependent.LastName)" />
    </div>
    <br />
    <div class="col-12 row">
        <span class="col-2"></span>
        <button type="submit" class="form-control col-1 btn btn-primary" @onclick="@(async () => await Add())">Add</button>
    </div>

</EditForm>

@*<div class="row">
    <div class="col-md-4">
        <form>
            <div class="form-group">
                <label for="Name" class="control-label">FirstName</label>
                <input for="Name" class="form-control" @bind="@dependent.FirstName" />
            </div>
            <div class="form-group">
                <label asp-for="Designation" class="control-label">LastName</label>
                <input for="Designation" class="form-control" @bind="@dependent.LastName" />
            </div>
            <div class="form-group">
                <button type="submit" class="btn btn-primary" @onclick="@(async () => await Add())">Save</button>
                <button class="btn btn-light" @onclick="@Cancel">Cancel</button>
            </div>
        </form>
    </div>
</div>*@
<br />

@code {
    [Parameter]
    public string employeeId { get; set; }
    private AddDependentModel dependent = new AddDependentModel();
    ElementReference publisherNameTextBox;


    protected override async Task OnInitializedAsync()
    {
        await Task.Run(() =>
        {
        });
        //eMedBenefits = await eBenefitsRepository.GetEmployeeMedBenefitsTestAsync();
    }

    private async Task Add()
    {
        dependent.EmployeeId = Guid.Parse(employeeId);
        dependent.Ssn = "123-45-6789";
        dependent.Dob = new DateTime(2010, 1, 1);
        await dependentRepository.AddDependentAsync(dependent);
        navigation.NavigateTo("/benefits/Benefit", true);
    }

    private async Task Cancel()
    {
        await Task.Run(() =>
        {
            navigation.NavigateTo("/benefits/Benefit", true);

        });
    }
}
